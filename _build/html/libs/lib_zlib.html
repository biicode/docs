


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Zlib &mdash; biicode docs 0.1.11 documentation</title>
  

  
  

  
  <link href='http://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700' rel='stylesheet' type='text/css'>
  
      
  
  
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:'../',
        VERSION:'0.1.11',
        COLLAPSE_INDEX:false,
        FILE_SUFFIX:'.html',
        HAS_SOURCE:  true
      };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
    
    
  


  <link rel="stylesheet" href="../_static/theme.css" type="text/css" />
  <script type="text/javascript" src="_static/theme.js"></script>


  
    <link rel="top" title="biicode docs 0.1.11 documentation" href="../index.html"/>
        <link rel="up" title="List of Available Libraries" href="../libraries.html"/>
        <link rel="next" title="Some biicode Tutorials" href="../tutorials.html"/>
        <link rel="prev" title="Crypto++, a free C++ class library of cryptographic schemes" href="lib_crypto++.html"/> 

  <script src="//cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="body-for-nav">

  
  <nav class="nav-top">
    <div class="nav-top-mobile">
      <i data-toggle="nav-top" class="icon icon-reorder"></i>
      <a href="../index.html" class="icon icon-home"> biicode docs</a>
    </div>
    <div class="nav-top-standard">
      <ul class="main-menu">
        <li><a href="../index.html" class="icon icon-home"> biicode docs</a></li>
      </ul>
    </div>
  </nav>



  <div class="grid-for-nav">
    
    
    <nav data-toggle="nav-shift" class="nav-side">
      <div class="side-nav-search">
        <form class="form" action="../search.html" method="get">
  <input type="text" name="q" placeholder="Search docs" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      </div>

      <div class="menu menu-vertical" data-spy="affix">
        
        
            <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../intro-to-biicode.html">Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../intro-to-biicode.html#what-is-biicode">What is biicode</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro-to-biicode.html#biicode-beta">Biicode BETA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro-to-biicode.html#what-problem-does-it-solve">What problem does it solve?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro-to-biicode.html#some-basic-concepts">Some basic concepts</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../installing-biicode.html">Installation and Setup</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html">Changelog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installing-biicode.html#download-and-install-the-client-binaries">Download and install the client binaries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installing-biicode.html#install-the-development-tools">Install the development tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installing-biicode.html#create-a-workspace">Create a workspace</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../getting-started.html">Getting Started With biicode</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../start/helloworld.html">&#8220;Hello World!&#8221; in C++</a></li>
<li class="toctree-l2"><a class="reference internal" href="../start/c++challenge.html">Solving the C++ Challenge</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../basic-commands.html">Basic Commands</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../basic-commands.html#finding-dependencies">Finding dependencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basic-commands.html#the-file-filter">The File Filter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basic-commands.html#policies">Policies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basic-commands.html#changing-your-policy-tag">Changing your policy tag</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basic-commands.html#custom-settings">Custom Settings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basic-commands.html#using-and-ide">Using and IDE</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../advanced-features.html">Advanced Features</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../advanced-features.html#virtual-resources">Virtual Resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="../advanced-features.html#edit-dependencies">Edit Dependencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../advanced-features.html#merge-a-branch">Merge a Branch</a></li>
<li class="toctree-l2"><a class="reference internal" href="../advanced-features.html#dependencies-configuration">Dependencies Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../advanced-features.html#c-compiling-options">C++ Compiling Options</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../libraries.html">List of Available Libraries</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="lib_cimg.html">CImg</a></li>
<li class="toctree-l2"><a class="reference internal" href="lib_crypto++.html">Crypto++, a free C++ class library of cryptographic schemes</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">Zlib</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials.html">Some biicode Tutorials</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/google-test-tutorial.html">Google Test Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/helloworld.html">&#8220;Hello World!&#8221; in C++</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/updating-blocks-and-dependencies.html">Updating blocks and dependencies</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../faqs.html">Frequently Asked Questions</a></li>
</ul>

        
      </div>
      <div class="rst-versions" data-toggle="rst-versions">
  <span class="rst-current-version rst-out-of-date" data-toggle="rst-current-version">
    <span class="icon icon-book"> Read the Docs</span>
    v:  
    (old) 
    <span class="icon icon-caret-down"></span>
  </span>
  <div class="rst-other-versions">
    <dl>
      <dt>Versions</dt>
      
    </dl>
    <dl>
      <dt>Downloads</dt>
      
    </dl>
    <dl>
      <dt>On Read the Docs</dt>
      <dd>
        <a href="///projects//?fromdocs=">Project Home</a>
      </dd>
      <dd>
        <a href="///builds//?fromdocs=">Builds</a>
      </dd>
    </dl>
    <hr/>
    Free document hosting provided by <a href="http://www.readthedocs.org">Read the Docs</a>.
  </div>
</div>
      &nbsp;
    </nav>

    <section data-toggle="nav-shift" class="nav-content-wrap">

      
      <div class="nav-content">
        <div class="rst-content">
          <ul class="breadcrumbs">
  <li><a href="../index.html">Docs</a> &raquo;</li>
  <li><a href="">Zlib</a></li>
  
</ul>
<hr/>

          
  <div class="section" id="zlib">
<h1>Zlib<a class="headerlink" href="#zlib" title="Permalink to this headline">¶</a></h1>
<p>Zlib is a software library written in C language used for data compression. For more information about this library, visit its official website or Documentation.</p>
<p>This is the biicode library site and this is the biicode library examples.</p>
<div class="section" id="usage-example-difficulty-medium">
<h2>Usage example (difficulty: medium)<a class="headerlink" href="#usage-example-difficulty-medium" title="Permalink to this headline">¶</a></h2>
<p>To check this library, we&#8217;re making an example to compress and decompress a single file. Then you could create a *.h and a *.cpp file named infdef (inflate and deflate) and a zpipe.cpp which would be, for example, in ~/hive_directory/src/user_name/hive_name/.</p>
<p>The following code would be in each one.</p>
<p><strong>infdef.h</strong></p>
<div class="highlight-cpp"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30</pre></div></td><td class="code"><div class="highlight"><pre><span class="cp">#pragma once</span>

<span class="hll"><span class="cp">#include &lt;stdio.h&gt;</span>
</span><span class="hll"><span class="cp">#include &lt;assert.h&gt;</span>
</span><span class="hll"><span class="cp">#include &quot;zlib/zlib/zlib.h&quot;</span>
</span>
<span class="cm">/*********** Methods declarations *************/</span>

<span class="cm">/* Compress from file source to file dest until EOF on source.</span>
<span class="cm">def() returns Z_OK on success, Z_MEM_ERROR if memory could not be</span>
<span class="cm">allocated for processing, Z_STREAM_ERROR if an invalid compression</span>
<span class="cm">level is supplied, Z_VERSION_ERROR if the version of zlib.h and the</span>
<span class="cm">version of the library linked do not match, or Z_ERRNO if there is</span>
<span class="cm">an error reading or writing the files. */</span>

<span class="hll"><span class="kt">int</span> <span class="nf">def</span><span class="p">(</span><span class="kt">FILE</span> <span class="o">*</span><span class="n">source</span><span class="p">,</span> <span class="kt">FILE</span> <span class="o">*</span><span class="n">dest</span><span class="p">,</span> <span class="kt">int</span> <span class="n">level</span><span class="p">);</span>
</span>
<span class="cm">/* Decompress from file source to file dest until stream ends or EOF.</span>
<span class="cm">inf() returns Z_OK on success, Z_MEM_ERROR if memory could not be</span>
<span class="cm">allocated for processing, Z_DATA_ERROR if the deflate data is</span>
<span class="cm">invalid or incomplete, Z_VERSION_ERROR if the version of zlib.h and</span>
<span class="cm">the version of the library linked do not match, or Z_ERRNO if there</span>
<span class="cm">is an error reading or writing the files. */</span>

<span class="kt">int</span> <span class="nf">inf</span><span class="p">(</span><span class="kt">FILE</span> <span class="o">*</span><span class="n">source</span><span class="p">,</span> <span class="kt">FILE</span><span class="o">*</span> <span class="n">dest</span><span class="p">);</span>


<span class="cm">/* report a zlib or i/o error */</span>

<span class="kt">void</span> <span class="nf">zerr</span><span class="p">(</span><span class="kt">int</span> <span class="n">ret</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
<p><strong>infdef.cpp</strong></p>
<div class="highlight-cpp"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137</pre></div></td><td class="code"><div class="highlight"><pre><span class="cp">#include &quot;infdef.h&quot;</span>

<span class="cp">#define CHUNK 20000</span>

<span class="kt">int</span> <span class="nf">def</span><span class="p">(</span><span class="kt">FILE</span> <span class="o">*</span><span class="n">source</span><span class="p">,</span> <span class="kt">FILE</span> <span class="o">*</span><span class="n">dest</span><span class="p">,</span> <span class="kt">int</span> <span class="n">level</span><span class="p">)</span>
<span class="p">{</span>
   <span class="kt">int</span> <span class="n">ret</span><span class="p">,</span> <span class="n">flush</span><span class="p">;</span>
   <span class="kt">unsigned</span> <span class="n">have</span><span class="p">;</span>
   <span class="n">z_stream</span> <span class="n">strm</span><span class="p">;</span>
   <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">in</span><span class="p">[</span><span class="n">CHUNK</span><span class="p">];</span>
   <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">out</span><span class="p">[</span><span class="n">CHUNK</span><span class="p">];</span>

  <span class="cm">/* allocate deflate state */</span>
   <span class="n">strm</span><span class="p">.</span><span class="n">zalloc</span> <span class="o">=</span> <span class="n">Z_NULL</span><span class="p">;</span>
   <span class="n">strm</span><span class="p">.</span><span class="n">zfree</span> <span class="o">=</span> <span class="n">Z_NULL</span><span class="p">;</span>
   <span class="n">strm</span><span class="p">.</span><span class="n">opaque</span> <span class="o">=</span> <span class="n">Z_NULL</span><span class="p">;</span>
   <span class="n">ret</span> <span class="o">=</span> <span class="n">deflateInit</span><span class="p">(</span><span class="o">&amp;</span><span class="n">strm</span><span class="p">,</span> <span class="n">level</span><span class="p">);</span>
   <span class="k">if</span> <span class="p">(</span><span class="n">ret</span> <span class="o">!=</span> <span class="n">Z_OK</span><span class="p">)</span>
     <span class="k">return</span> <span class="n">ret</span><span class="p">;</span>

  <span class="cm">/* compress until end of file */</span>
   <span class="k">do</span> <span class="p">{</span>
     <span class="n">strm</span><span class="p">.</span><span class="n">avail_in</span> <span class="o">=</span> <span class="n">fread</span><span class="p">(</span><span class="n">in</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">CHUNK</span><span class="p">,</span> <span class="n">source</span><span class="p">);</span>
     <span class="k">if</span> <span class="p">(</span><span class="n">ferror</span><span class="p">(</span><span class="n">source</span><span class="p">))</span> <span class="p">{</span>
       <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">deflateEnd</span><span class="p">(</span><span class="o">&amp;</span><span class="n">strm</span><span class="p">);</span>
       <span class="k">return</span> <span class="n">Z_ERRNO</span><span class="p">;</span>
     <span class="p">}</span>
     <span class="n">flush</span> <span class="o">=</span> <span class="n">feof</span><span class="p">(</span><span class="n">source</span><span class="p">)</span> <span class="o">?</span> <span class="n">Z_FINISH</span> <span class="o">:</span> <span class="n">Z_NO_FLUSH</span><span class="p">;</span>
     <span class="n">strm</span><span class="p">.</span><span class="n">next_in</span> <span class="o">=</span> <span class="n">in</span><span class="p">;</span>

   <span class="cm">/* run deflate() on input until output buffer not full, finish</span>
<span class="cm">     compression if all of source has been read in */</span>
     <span class="k">do</span> <span class="p">{</span>
       <span class="n">strm</span><span class="p">.</span><span class="n">avail_out</span> <span class="o">=</span> <span class="n">CHUNK</span><span class="p">;</span>
       <span class="n">strm</span><span class="p">.</span><span class="n">next_out</span> <span class="o">=</span> <span class="n">out</span><span class="p">;</span>
       <span class="n">ret</span> <span class="o">=</span> <span class="n">deflate</span><span class="p">(</span><span class="o">&amp;</span><span class="n">strm</span><span class="p">,</span> <span class="n">flush</span><span class="p">);</span> <span class="cm">/* no bad return value */</span>
       <span class="n">assert</span><span class="p">(</span><span class="n">ret</span> <span class="o">!=</span> <span class="n">Z_STREAM_ERROR</span><span class="p">);</span> <span class="cm">/* state not clobbered */</span>
       <span class="n">have</span> <span class="o">=</span> <span class="n">CHUNK</span> <span class="o">-</span> <span class="n">strm</span><span class="p">.</span><span class="n">avail_out</span><span class="p">;</span>

       <span class="k">if</span> <span class="p">(</span><span class="n">fwrite</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">have</span><span class="p">,</span> <span class="n">dest</span><span class="p">)</span> <span class="o">!=</span> <span class="n">have</span> <span class="o">||</span> <span class="n">ferror</span><span class="p">(</span><span class="n">dest</span><span class="p">))</span> <span class="p">{</span>
         <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">deflateEnd</span><span class="p">(</span><span class="o">&amp;</span><span class="n">strm</span><span class="p">);</span>
         <span class="k">return</span> <span class="n">Z_ERRNO</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">}</span> <span class="k">while</span> <span class="p">(</span><span class="n">strm</span><span class="p">.</span><span class="n">avail_out</span> <span class="o">==</span> <span class="mi">0</span><span class="p">);</span>
      <span class="n">assert</span><span class="p">(</span><span class="n">strm</span><span class="p">.</span><span class="n">avail_in</span> <span class="o">==</span> <span class="mi">0</span><span class="p">);</span> <span class="cm">/* all input will be used */</span>

   <span class="cm">/* done when last data in file processed */</span>
    <span class="p">}</span> <span class="k">while</span> <span class="p">(</span><span class="n">flush</span> <span class="o">!=</span> <span class="n">Z_FINISH</span><span class="p">);</span>
    <span class="n">assert</span><span class="p">(</span><span class="n">ret</span> <span class="o">==</span> <span class="n">Z_STREAM_END</span><span class="p">);</span> <span class="cm">/* stream will be complete */</span>

  <span class="cm">/* clean up and return */</span>
   <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">deflateEnd</span><span class="p">(</span><span class="o">&amp;</span><span class="n">strm</span><span class="p">);</span>
   <span class="k">return</span> <span class="n">Z_OK</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">inf</span><span class="p">(</span><span class="kt">FILE</span> <span class="o">*</span><span class="n">source</span><span class="p">,</span> <span class="kt">FILE</span><span class="o">*</span> <span class="n">dest</span><span class="p">)</span>
<span class="p">{</span>
   <span class="kt">int</span> <span class="n">ret</span><span class="p">;</span>
   <span class="kt">unsigned</span> <span class="n">have</span><span class="p">;</span>
   <span class="n">z_stream</span> <span class="n">strm</span><span class="p">;</span>
   <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">in</span><span class="p">[</span><span class="n">CHUNK</span><span class="p">];</span>
   <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">out</span><span class="p">[</span><span class="n">CHUNK</span><span class="p">];</span>

  <span class="cm">/* allocate inflate state */</span>
   <span class="n">strm</span><span class="p">.</span><span class="n">zalloc</span> <span class="o">=</span> <span class="n">Z_NULL</span><span class="p">;</span>
   <span class="n">strm</span><span class="p">.</span><span class="n">zfree</span> <span class="o">=</span> <span class="n">Z_NULL</span><span class="p">;</span>
   <span class="n">strm</span><span class="p">.</span><span class="n">opaque</span> <span class="o">=</span> <span class="n">Z_NULL</span><span class="p">;</span>
   <span class="n">strm</span><span class="p">.</span><span class="n">avail_in</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
   <span class="n">strm</span><span class="p">.</span><span class="n">next_in</span> <span class="o">=</span> <span class="n">Z_NULL</span><span class="p">;</span>
   <span class="n">ret</span> <span class="o">=</span> <span class="n">inflateInit</span><span class="p">(</span><span class="o">&amp;</span><span class="n">strm</span><span class="p">);</span>
   <span class="k">if</span> <span class="p">(</span><span class="n">ret</span> <span class="o">!=</span> <span class="n">Z_OK</span><span class="p">)</span>
     <span class="k">return</span> <span class="n">ret</span><span class="p">;</span>

  <span class="cm">/* decompress until deflate stream ends or end of file */</span>
   <span class="k">do</span> <span class="p">{</span>
     <span class="n">strm</span><span class="p">.</span><span class="n">avail_in</span> <span class="o">=</span> <span class="n">fread</span><span class="p">(</span><span class="n">in</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">CHUNK</span><span class="p">,</span> <span class="n">source</span><span class="p">);</span>
     <span class="k">if</span> <span class="p">(</span><span class="n">ferror</span><span class="p">(</span><span class="n">source</span><span class="p">))</span> <span class="p">{</span>
       <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">inflateEnd</span><span class="p">(</span><span class="o">&amp;</span><span class="n">strm</span><span class="p">);</span>
       <span class="k">return</span> <span class="n">Z_ERRNO</span><span class="p">;</span>
     <span class="p">}</span>
     <span class="k">if</span> <span class="p">(</span><span class="n">strm</span><span class="p">.</span><span class="n">avail_in</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
       <span class="k">break</span><span class="p">;</span>
     <span class="n">strm</span><span class="p">.</span><span class="n">next_in</span> <span class="o">=</span> <span class="n">in</span><span class="p">;</span>

    <span class="cm">/* run inflate() on input until output buffer not full */</span>
     <span class="k">do</span> <span class="p">{</span>
       <span class="n">strm</span><span class="p">.</span><span class="n">avail_out</span> <span class="o">=</span> <span class="n">CHUNK</span><span class="p">;</span>
       <span class="n">strm</span><span class="p">.</span><span class="n">next_out</span> <span class="o">=</span> <span class="n">out</span><span class="p">;</span>
       <span class="n">ret</span> <span class="o">=</span> <span class="n">inflate</span><span class="p">(</span><span class="o">&amp;</span><span class="n">strm</span><span class="p">,</span> <span class="n">Z_NO_FLUSH</span><span class="p">);</span>
       <span class="n">assert</span><span class="p">(</span><span class="n">ret</span> <span class="o">!=</span> <span class="n">Z_STREAM_ERROR</span><span class="p">);</span> <span class="cm">/* state not clobbered */</span>
       <span class="k">switch</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="p">{</span>
         <span class="k">case</span> <span class="n">Z_NEED_DICT</span>:
         <span class="n">ret</span> <span class="o">=</span> <span class="n">Z_DATA_ERROR</span><span class="p">;</span> <span class="cm">/* and fall through */</span>
         <span class="k">case</span> <span class="n">Z_DATA_ERROR</span>:
         <span class="k">case</span> <span class="n">Z_MEM_ERROR</span>:
        <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">inflateEnd</span><span class="p">(</span><span class="o">&amp;</span><span class="n">strm</span><span class="p">);</span>
         <span class="k">return</span> <span class="n">ret</span><span class="p">;</span>
       <span class="p">}</span>
       <span class="n">have</span> <span class="o">=</span> <span class="n">CHUNK</span> <span class="o">-</span> <span class="n">strm</span><span class="p">.</span><span class="n">avail_out</span><span class="p">;</span>
       <span class="k">if</span> <span class="p">(</span><span class="n">fwrite</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">have</span><span class="p">,</span> <span class="n">dest</span><span class="p">)</span> <span class="o">!=</span> <span class="n">have</span> <span class="o">||</span> <span class="n">ferror</span><span class="p">(</span><span class="n">dest</span><span class="p">))</span> <span class="p">{</span>
         <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">inflateEnd</span><span class="p">(</span><span class="o">&amp;</span><span class="n">strm</span><span class="p">);</span>
         <span class="k">return</span> <span class="n">Z_ERRNO</span><span class="p">;</span>
       <span class="p">}</span>
      <span class="p">}</span> <span class="k">while</span> <span class="p">(</span><span class="n">strm</span><span class="p">.</span><span class="n">avail_out</span> <span class="o">==</span> <span class="mi">0</span><span class="p">);</span>

     <span class="cm">/* done when inflate() says it&#39;s done */</span>
     <span class="p">}</span> <span class="k">while</span> <span class="p">(</span><span class="n">ret</span> <span class="o">!=</span> <span class="n">Z_STREAM_END</span><span class="p">);</span>

  <span class="cm">/* clean up and return */</span>
   <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">inflateEnd</span><span class="p">(</span><span class="o">&amp;</span><span class="n">strm</span><span class="p">);</span>
   <span class="k">return</span> <span class="n">ret</span> <span class="o">==</span> <span class="n">Z_STREAM_END</span> <span class="o">?</span> <span class="n">Z_OK</span> <span class="o">:</span> <span class="n">Z_DATA_ERROR</span><span class="p">;</span>
<span class="p">}</span>

  <span class="cm">/* report a zlib or i/o error */</span>
 <span class="kt">void</span> <span class="nf">zerr</span><span class="p">(</span><span class="kt">int</span> <span class="n">ret</span><span class="p">)</span>
 <span class="p">{</span>
    <span class="n">fputs</span><span class="p">(</span><span class="s">&quot;zpipe: &quot;</span><span class="p">,</span> <span class="n">stderr</span><span class="p">);</span>
    <span class="k">switch</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">case</span> <span class="n">Z_ERRNO</span>:
        <span class="k">if</span> <span class="p">(</span><span class="n">ferror</span><span class="p">(</span><span class="n">stdin</span><span class="p">))</span>
          <span class="n">fputs</span><span class="p">(</span><span class="s">&quot;error reading stdin</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">stderr</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">ferror</span><span class="p">(</span><span class="n">stdout</span><span class="p">))</span>
          <span class="n">fputs</span><span class="p">(</span><span class="s">&quot;error writing stdout</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">stderr</span><span class="p">);</span>
        <span class="k">break</span><span class="p">;</span>
      <span class="k">case</span> <span class="n">Z_STREAM_ERROR</span>:
        <span class="n">fputs</span><span class="p">(</span><span class="s">&quot;invalid compression level</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">stderr</span><span class="p">);</span>
        <span class="k">break</span><span class="p">;</span>
      <span class="k">case</span> <span class="n">Z_DATA_ERROR</span>:
        <span class="n">fputs</span><span class="p">(</span><span class="s">&quot;invalid or incomplete deflate data</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">stderr</span><span class="p">);</span>
        <span class="k">break</span><span class="p">;</span>
      <span class="k">case</span> <span class="n">Z_MEM_ERROR</span>:
        <span class="n">fputs</span><span class="p">(</span><span class="s">&quot;out of memory</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">stderr</span><span class="p">);</span>
        <span class="k">break</span><span class="p">;</span>
      <span class="k">case</span> <span class="n">Z_VERSION_ERROR</span>:
        <span class="n">fputs</span><span class="p">(</span><span class="s">&quot;zlib version mismatch!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">stderr</span><span class="p">);</span>
    <span class="p">}</span>
 <span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p><strong>zpipe.cpp</strong></p>
<div class="highlight-cpp"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102</pre></div></td><td class="code"><div class="highlight"><pre><span class="cp">#include &quot;infdef.h&quot;</span>
<span class="cp">#include &lt;iostream&gt;</span>

<span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>

<span class="cm">/* compress or decompress */</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
   <span class="kt">int</span> <span class="n">ret</span><span class="p">;</span>
   <span class="n">string</span> <span class="n">request</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">;</span>

   <span class="k">while</span> <span class="p">(</span><span class="nb">true</span><span class="p">)</span>
   <span class="p">{</span>
      <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">&quot;Do you want to compress or decompress a file (to exit &#39;CTRL+C&#39;)? &lt;comp|decomp&gt;&quot;</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
      <span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">request</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">request</span><span class="o">==</span><span class="s">&quot;comp&quot;</span> <span class="o">||</span> <span class="n">request</span><span class="o">==</span><span class="s">&quot;decomp&quot;</span><span class="p">)</span>
        <span class="k">break</span><span class="p">;</span>
   <span class="p">}</span>

  <span class="n">string</span> <span class="n">name_file_source</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">;</span>
  <span class="n">string</span> <span class="n">name_file_dest</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">;</span>
  <span class="kt">float</span> <span class="n">size_src</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">size_dest</span><span class="o">=</span><span class="mf">0.0</span><span class="p">;</span>

  <span class="cm">/*</span>
<span class="cm">   Enter or path to file, for example:</span>
<span class="cm">   C:/Users/User/file.txt</span>
<span class="cm">   Or</span>
<span class="cm">   If you save the file in the bin folder, where</span>
<span class="cm">   you will have the *.exe file, you just need write</span>
<span class="cm">   name and extension file:</span>
<span class="cm">       file.txt</span>
<span class="cm">  */</span>

  <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">&quot;Enter file source name: &quot;</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
  <span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">name_file_source</span><span class="p">;</span>
  <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">&quot;Enter file destination name: &quot;</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
  <span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">name_file_dest</span><span class="p">;</span>

  <span class="kt">FILE</span> <span class="o">*</span><span class="n">source</span><span class="o">=</span><span class="nb">NULL</span><span class="p">;</span><span class="c1">//original file</span>
  <span class="kt">FILE</span><span class="o">*</span> <span class="n">dest</span><span class="o">=</span><span class="nb">NULL</span><span class="p">;</span> <span class="c1">//file to compress or decompress</span>

 <span class="cm">/* do compression if &quot;comp&quot; specified */</span>
   <span class="k">if</span> <span class="p">(</span><span class="n">request</span> <span class="o">==</span> <span class="s">&quot;comp&quot;</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">try</span>
      <span class="p">{</span>
         <span class="n">source</span> <span class="o">=</span> <span class="n">fopen</span><span class="p">(</span><span class="n">name_file_source</span><span class="p">.</span><span class="n">c_str</span><span class="p">(),</span><span class="s">&quot;r&quot;</span><span class="p">);</span>
         <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">source</span><span class="p">)</span>
            <span class="k">throw</span> <span class="mi">0</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">catch</span> <span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">)</span>
      <span class="p">{</span>
         <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;File does not exist, method return with &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">n</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
         <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
      <span class="p">}</span>

      <span class="n">dest</span> <span class="o">=</span> <span class="n">fopen</span><span class="p">(</span><span class="n">name_file_dest</span><span class="p">.</span><span class="n">c_str</span><span class="p">(),</span><span class="s">&quot;wb&quot;</span><span class="p">);</span><span class="c1">//wb because write to binary format</span>
      <span class="n">ret</span> <span class="o">=</span> <span class="n">def</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">dest</span> <span class="p">,</span><span class="n">Z_DEFAULT_COMPRESSION</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">ret</span> <span class="o">!=</span> <span class="n">Z_OK</span><span class="p">)</span>
         <span class="n">zerr</span><span class="p">(</span><span class="n">ret</span><span class="p">);</span>
      <span class="k">else</span>
      <span class="p">{</span>
        <span class="cm">/* Calculate size file to see the difference */</span>
        <span class="n">size_src</span> <span class="o">=</span> <span class="n">ftell</span><span class="p">(</span><span class="n">source</span><span class="p">);</span>
        <span class="n">size_dest</span> <span class="o">=</span> <span class="n">ftell</span><span class="p">(</span><span class="n">dest</span><span class="p">);</span>

        <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">&quot;The original file size is: &quot;</span><span class="o">&lt;&lt;</span><span class="n">size_src</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
        <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">&quot;The file size after being compressed is: &quot;</span><span class="o">&lt;&lt;</span><span class="n">size_dest</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">return</span> <span class="n">ret</span><span class="p">;</span>
   <span class="p">}</span>

   <span class="cm">/* do decompression if &quot;decomp&quot; specified */</span>
   <span class="k">else</span> <span class="p">{</span>
      <span class="n">try</span>
      <span class="p">{</span>
         <span class="n">source</span> <span class="o">=</span> <span class="n">fopen</span><span class="p">(</span><span class="n">name_file_source</span><span class="p">.</span><span class="n">c_str</span><span class="p">(),</span><span class="s">&quot;rb&quot;</span><span class="p">);</span><span class="c1">//rb because read from binary format</span>
         <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">source</span><span class="p">)</span>
            <span class="k">throw</span> <span class="mi">0</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">catch</span> <span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">)</span>
      <span class="p">{</span>
         <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;File does not exist, method return with &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">n</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
         <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
      <span class="p">}</span>

      <span class="n">dest</span> <span class="o">=</span> <span class="n">fopen</span><span class="p">(</span><span class="n">name_file_dest</span><span class="p">.</span><span class="n">c_str</span><span class="p">(),</span><span class="s">&quot;w&quot;</span><span class="p">);</span>
      <span class="n">ret</span> <span class="o">=</span> <span class="n">def</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">dest</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">ret</span> <span class="o">!=</span> <span class="n">Z_OK</span><span class="p">)</span>
         <span class="n">zerr</span><span class="p">(</span><span class="n">ret</span><span class="p">);</span>
      <span class="k">else</span>
      <span class="p">{</span>
        <span class="cm">/* Calculate size file to see the difference */</span>
        <span class="n">size_src</span> <span class="o">=</span> <span class="n">ftell</span><span class="p">(</span><span class="n">source</span><span class="p">);</span>
        <span class="n">size_dest</span> <span class="o">=</span> <span class="n">ftell</span><span class="p">(</span><span class="n">dest</span><span class="p">);</span>

        <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">&quot;The original file size is: &quot;</span><span class="o">&lt;&lt;</span><span class="n">size_src</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
        <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">&quot;The file size after being decompressed is: &quot;</span><span class="o">&lt;&lt;</span><span class="n">size_dest</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">return</span> <span class="n">ret</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Then, you need find all the depencies of your project, in this case, zlib.h, so execute in console</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>bii find
</pre></div>
</div>
<p>Next, you can already run the code:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>bii cpp:run
</pre></div>
</div>
<p>Then you&#8217;ll be requested to select compression or decompression any file, and the file source name and file destination name.</p>
<p>This will be the output if you would want to compress a file.txt which is in your desktop directory and the compressed name file would be file.gz. The last one will be created in your ~/hive_directory/bin/ directory</p>
<div class="highlight-bash"><div class="highlight"><pre>Do you want to compress or decompress a file <span class="o">(</span>to <span class="nb">exit</span> <span class="s1">&#39;CTRL+C&#39;</span><span class="o">)</span>? &lt;comp|decomp&gt;
comp
Enter file <span class="nb">source </span>name:
C:<span class="se">\U</span>sers<span class="se">\U</span>suario<span class="se">\D</span>esktop<span class="se">\f</span>ile.txt
Enter file destination name:
file.gz
The original file size is: 16944
The file size after being compressed is: 5152
</pre></div>
</div>
<p>In this case file.txt had a size of 16944 bytes and file.gz 5152 bytes.</p>
<p>Now, if you want to decompress the file.gz to check all is correct, run the code again and the output will be the next</p>
<div class="highlight-bash"><div class="highlight"><pre>Do you want to compress or decompress a file <span class="o">(</span>to <span class="nb">exit</span> <span class="s1">&#39;CTRL+C&#39;</span><span class="o">)</span>? &lt;comp|decomp&gt;
decomp
Enter file <span class="nb">source </span>name:
file.gz
Enter file destination name:
myfile.txt
The original file size is: 5152
The file size after being decompressed is: 16944
</pre></div>
</div>
<p>Finally, you can see that the new file, myfile.txt, has been created in the ~/hive_directory/bin/ directory and it´s exactly like the file.txt in terms of size and content.</p>
</div>
</div>


          <footer>
  <hr/>
      &copy; Copyright 2013, biicode.

</footer>
        </div>
      </div>

    </section>

  </div>
</body>
</html>